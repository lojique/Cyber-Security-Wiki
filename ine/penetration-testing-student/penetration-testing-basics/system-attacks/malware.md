# Malware

## Malware

Any software used to misuse computer systems with the intent to:

* Cause DOS
* Spy on users activity
* Get unauthorized control over one or more computer systems
* Cause other malicious activities

## **Virus**

Small piece of code that spreads from cpu to cpu, w/o any direct action or authorization by the owners of the infected machines

Usually copy themselves to special sections of the hard disk, inside legit programs or docs. They then run every time an infected program or file is opened

## **Trojan horse**

Malware that comes embedded in a seemingly harmless file such as an executable, an MS Office doc, a screen saver or a PDF file

Most common are backdoors which lets an attacker get a shell on an infected system

## **Backdoor**

Software made by two components: a server and a backdoor client

The server runs on a victim machine listening on the network and accepting connections.

The client usually runs on the attacker machine, and it is used to connect to the backdoor to control it

* If a wise sysadmin configures the network firewall to block connections from the internet to internal machine, then the attacker will not be able to connect to the backdoor
* Connection tries from the Internet to an internal machine will raise some alarms, so to make the traffic look legit would be to use a connect-back backdoor.
  * A connect-back backdoor, or reverse backdoor, is a common mechanism to bypass firewalls
  * instead of having the victim machine act as a server and listening to the client's command, it acts as a client and connects back to the penetration tester's machine.
  * The attacker machine would listen on a port that is known to be commonly allowed on most of the firewalls, such as port 80
  * a firewall cannot tell the difference between a user surfing the web and a backdoor connecting back to the attacker's machine

## **Rootkit**

Malware designed to hide itself from users and antivirus program in order to completely subvert the OS functioning

Lets an attacker maintain privileged access to the victim machine without being noticed

## **Bootkit**

Rootkits which circumvent OS protection mechanisms by executing during the bootstrap phrase

They start before the OS, so they get complete control over the machine and the OS.

## **Adware**

Annoying software that shows ads to computer users

## **Spyware**

Software used to collect info about users' activity such as the OS installed, visited websites, passwords, etc.

The info is sent back to a log collection server controlled by the attacker

## **Greyware**

A general term used to indicate malware which does not fall under a specific category.

For example, it can be either spyware, adware or both

## **Dialer**

A software that tries to dial numbers on dial-up connections in order to collect money from the victim's phone bill

Nowadays, they target smartphones

## **Keylogger**

Software which records every keystroke on the remote victim machine

Operations performed by keyloggers are:

* Recording keystrokes
* Recording the window name where the victim user was typing
* saving the keystrokes in a log file on the victim machine
* Sending the logs to a server controlled by the pentester

Subject to the same restrictions that firewalls pose to backdoors

If configured wisely, the traffic they generate should not be stopped by a firewall

When run on a remote machine, login info, emails sent, documents typed, and chats get recorded

Login info can be used to exploit systems, while chat or email info can be used to mount targeted and social engineering attacks

There are also:

* **Hardware keyloggers**
  * Small devices you can install between a keyboard and a computer
  * They log keystrokes into an internal memory.
  * Attacker has to install it and retrieve it
* **Rootkit keyloggers**
  * Stealthy and more invisible to the victim user than software keyloggers
  * Software keyloggers working at the kernel level by hijacking the OS APIs to record keystrokes
  * Every time a key is pressed on a keyboard, a particular function of the OS Kernel is called through a mechanism called an interrupt
  * There are many different interrupts in a system, each handling a specific function in the system: reading/writing to disk, calling device drivers, and so on
  * The interrupt calls a particular function of the OS that actually performs the operation intended for the key
  * By taking control of this function, the rootkit manages to know which key has been pressed and record it for later use.
  * First, the keylogger logs the key pressed and then it calls the original function of the OS

## Bots

Small pieces of software that get installed on millions of internet-connected machines to perform DDOS or serving as spamming sources

They are commanded remotely by a so-called C2 server which can instruct thousands or even millions of bots to perform a given operation simultaneously

## Ransomware

Software the encrypts a computer or smartphone content with a secret key

It then asks its victim for a ransom to give them the content back

## Data stealing malware

Stealing the most important data on the victim's hard disk and sending it back to the attacker

Most of the time targeted to a specific company

## Worms

Spread over the network by exploiting OSs and software vulnerabilities.

Can also exploit default creds or misconfigurations to attack a service or a machine

Usually part of other malware and offer an entry point into the target system
