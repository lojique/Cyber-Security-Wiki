# Wireless Pentesting

## Tools

* airodump-ng
* wifite2
* hcxtools
* eaphammer

First step when you connect to the box is to disable everything that manages the Wi-Fi interface with: `airmon-ng check kill`

## Monitor mode

Monitor mode allows a computer with a wireless network interface controller to monitor all traffic received from the wireless network without associating to any particular network.

```bash
airmon-ng start <wireless_iface>            # Put interface in monitor mode      
```

## Update Airodump-ng OUI database

Make sure the airodump-ng OUI (Organizationally Unique Identifier) database is up to date

```bash
sudo airodump-ng-oui-update
```

## Launch Airodump-ng

Once the wireless network interface is in monitor mode, we can launch airodump-ng to enumerate wireless networks. Airodump-ng will hop on all channels for all band specified if no channel is specified.

```bash
airodump-ng mon0 --write <filename> --band abg --uptime --wps --manufacturer

airodump-ng wlan0 --output-format pcap -w capture_march_29_scope --band abg --uptime --manufacturer --wps --essid-regex '(SSID|SSID|SSID)'
```

| Option               | Description                                                     |
| -------------------- | --------------------------------------------------------------- |
| `--write <filename>` | Save the dump file with the specified prefix                    |
| `--band abg`         | Band on which airodump-ng should hop                            |
| `--channel <#>`      | Capture traffic only on specific channel (no frequency hopping) |
| `--uptime`           | Show AP uptime                                                  |
| `--wps`              | Display AP which support Wi-Fi Protected Setup                  |
| `--manufacturer`     | Show AP manufacturer based on the OUI                           |

## Connecting to a network

If for example, there is an SSID that is an OPN (open network), then you can connect to it with:

```bash
nmcli dev wifi connect <SSID>
```

For WPA2-PSK you do handshake or pmkid capture, then you try yo crack them to get the PSK using a crackbox

for WPA2 Enterprise, you fake an access point using eaphammer, and try to deauth user until someone connect to your rogue access point. If someone actually authenticate, you either get their NTLM hash, or cleartext credentials (if the protocol is downgraded)
